{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-53317a04\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  key: 0,\n  class: \"text-danger\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1 /* HOISTED */));\nexport function render(_ctx, _cache) {\n  const _component_b_form_input = _resolveComponent(\"b-form-input\");\n  const _component_b_form_group = _resolveComponent(\"b-form-group\");\n  const _component_b_form = _resolveComponent(\"b-form\");\n  const _component_b_modal = _resolveComponent(\"b-modal\");\n  return _openBlock(), _createBlock(_component_b_modal, {\n    id: \"add-video-modal\",\n    modelValue: _ctx.isModalVisible,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _ctx.isModalVisible = $event),\n    title: \"Add New Video\",\n    onOk: _ctx.handleSubmit\n  }, {\n    default: _withCtx(() => [_createVNode(_component_b_form, {\n      onSubmit: _withModifiers(_ctx.handleSubmit, [\"stop\", \"prevent\"])\n    }, {\n      default: _withCtx(() => [_createVNode(_component_b_form_group, {\n        label: \"Title\",\n        \"label-for\": \"video-title\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_b_form_input, {\n          id: \"video-title\",\n          modelValue: _ctx.newVideo.title,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _ctx.newVideo.title = $event),\n          required: \"\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_b_form_group, {\n        label: \"Video\",\n        \"label-for\": \"video\"\n      }, {\n        default: _withCtx(() => [_createElementVNode(\"input\", {\n          id: \"video\",\n          type: \"file\",\n          onChange: _cache[1] || (_cache[1] = (...args) => _ctx.handleFileUpload && _ctx.handleFileUpload(...args)),\n          required: \"\"\n        }, null, 32 /* NEED_HYDRATION */), _ctx.videoError ? (_openBlock(), _createElementBlock(\"small\", _hoisted_1, [_hoisted_2, _createTextVNode(_toDisplayString(_ctx.videoError), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true)]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"onSubmit\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\", \"onOk\"]);\n}","map":{"version":3,"names":["key","class","_createElementVNode","_createBlock","_component_b_modal","id","modelValue","_ctx","isModalVisible","_cache","$event","title","onOk","handleSubmit","default","_withCtx","_createVNode","_component_b_form","onSubmit","_withModifiers","_component_b_form_group","label","_component_b_form_input","newVideo","required","_","type","onChange","args","handleFileUpload","videoError","_createElementBlock","_hoisted_1","_hoisted_2","_createTextVNode","_toDisplayString","_createCommentVNode"],"sources":["C:\\xampp\\htdocs\\assessment_test\\mystaff_frontend\\src\\components\\Modal\\AddModal.vue"],"sourcesContent":["<template>\r\n  <b-modal id=\"add-video-modal\" v-model=\"isModalVisible\" title=\"Add New Video\" @ok=\"handleSubmit\">\r\n    <b-form @submit.stop.prevent=\"handleSubmit\">\r\n      <b-form-group label=\"Title\" label-for=\"video-title\">\r\n        <b-form-input id=\"video-title\" v-model=\"newVideo.title\" required></b-form-input>\r\n      </b-form-group>\r\n      <b-form-group label=\"Video\" label-for=\"video\">\r\n        <input id=\"video\" type=\"file\" @change=\"handleFileUpload\" required>\r\n        <small class=\"text-danger\" v-if=\"videoError\"><br>{{ videoError }}</small>\r\n      </b-form-group>\r\n    </b-form>\r\n  </b-modal>\r\n</template>\r\n\r\n<script>\r\nimport Swal from 'sweetalert2';\r\nimport axios from '../../../axiosConfig';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      newVideo: {\r\n        title: '',\r\n        videoFile: null,\r\n      },\r\n      isModalVisible: false,\r\n      videoError: ''\r\n    };\r\n  },\r\n  methods: {\r\n    showModal() {\r\n      this.isModalVisible = true;\r\n    },\r\n    async handleSubmit() {\r\n      if (!this.newVideo.videoFile) {\r\n        this.videoError = 'Please upload a valid video file.';\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const formData = new FormData();\r\n        formData.append('title', this.newVideo.title);\r\n        formData.append('video', this.newVideo.videoFile);\r\n\r\n        const token = localStorage.getItem('token');\r\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n\r\n        const formData = new FormData();\r\n        if (!token) {\r\n          Swal.fire({\r\n            icon: 'error',\r\n            title: 'Error',\r\n            text: 'Authorization token is missing. Please log in again.'\r\n          });\r\n          return;\r\n        }\r\n\r\n        const config = {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`,\r\n            'Content-Type': 'multipart/form-data'\r\n          },\r\n          onUploadProgress: progressEvent => {\r\n            const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\r\n            console.log('Upload progress: ', percentCompleted);\r\n          }\r\n        };\r\n\r\n        const response = await axios.post('http://assessment.api/api/videos', formData, config);\r\n\r\n        Swal.fire({\r\n          icon: 'success',\r\n          title: 'Success',\r\n          text: response.data.message,\r\n          confirmButtonText: 'OK',\r\n        });\r\n        this.resetForm();\r\n      } catch (error) {\r\n        Swal.fire({\r\n          icon: 'error',\r\n          title: 'Error',\r\n          text: error.response?.data?.message || 'An error occurred'\r\n        });\r\n      }\r\n    },\r\n    handleFileUpload(event) {\r\n      const file = event.target.files[0];\r\n      const validVideoTypes = ['video/mp4', 'video/avi', 'video/mkv', 'video/mov', 'video/webm'];\r\n\r\n      if (file && validVideoTypes.includes(file.type)) {\r\n        this.newVideo.videoFile = file;\r\n        this.videoError = '';\r\n      } else {\r\n        this.newVideo.videoFile = null;\r\n        this.videoError = 'Please upload a valid video file.';\r\n      }\r\n    },\r\n    resetForm() {\r\n      this.newVideo = {\r\n        title: '',\r\n        videoFile: null,\r\n      };\r\n      this.videoError = '';\r\n      this.isModalVisible = false;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.text-danger {\r\n  color: #dc3545;\r\n}\r\n</style>\r\n"],"mappings":";;;EAAAA,GAAA;EAQeC,KAAK,EAAC;;gEAAgCC,mBAAA,CAAI;;;;;;uBAPvDC,YAAA,CAUUC,kBAAA;IAVDC,EAAE,EAAC,iBAAiB;IAD/BC,UAAA,EACyCC,IAAA,CAAAC,cAAc;IADvD,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IACyCH,IAAA,CAAAC,cAAc,GAAAE,MAAA;IAAEC,KAAK,EAAC,eAAe;IAAEC,IAAE,EAAEL,IAAA,CAAAM;;IADpFC,OAAA,EAAAC,QAAA,CAEI,MAQS,CARTC,YAAA,CAQSC,iBAAA;MARAC,QAAM,EAFnBC,cAAA,CAEkCZ,IAAA,CAAAM,YAAY;;MAF9CC,OAAA,EAAAC,QAAA,CAGM,MAEe,CAFfC,YAAA,CAEeI,uBAAA;QAFDC,KAAK,EAAC,OAAO;QAAC,WAAS,EAAC;;QAH5CP,OAAA,EAAAC,QAAA,CAIQ,MAAgF,CAAhFC,YAAA,CAAgFM,uBAAA;UAAlEjB,EAAE,EAAC,aAAa;UAJtCC,UAAA,EAIgDC,IAAA,CAAAgB,QAAQ,CAACZ,KAAK;UAJ9D,uBAAAF,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAIgDH,IAAA,CAAAgB,QAAQ,CAACZ,KAAK,GAAAD,MAAA;UAAEc,QAAQ,EAAR;;QAJhEC,CAAA;UAMMT,YAAA,CAGeI,uBAAA;QAHDC,KAAK,EAAC,OAAO;QAAC,WAAS,EAAC;;QAN5CP,OAAA,EAAAC,QAAA,CAOQ,MAAkE,CAAlEb,mBAAA,CAAkE;UAA3DG,EAAE,EAAC,OAAO;UAACqB,IAAI,EAAC,MAAM;UAAEC,QAAM,EAAAlB,MAAA,QAAAA,MAAA,UAAAmB,IAAA,KAAErB,IAAA,CAAAsB,gBAAA,IAAAtB,IAAA,CAAAsB,gBAAA,IAAAD,IAAA,CAAgB;UAAEJ,QAAQ,EAAR;2CACxBjB,IAAA,CAAAuB,UAAU,I,cAA3CC,mBAAA,CAAyE,SAAzEC,UAAyE,GAA5BC,UAAI,EARzDC,gBAAA,CAAAC,gBAAA,CAQ4D5B,IAAA,CAAAuB,UAAU,iB,KARtEM,mBAAA,e;QAAAX,CAAA;;MAAAA,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}